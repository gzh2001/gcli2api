# ================================================================
# GCLI2API 环境变量配置示例文件
# 复制此文件为 .env 并根据需要修改配置值
# ================================================================

# ================================================================
# 服务器配置
# ================================================================

# 服务器监听地址
# 默认: 0.0.0.0 (监听所有网络接口)
HOST=0.0.0.0

# 服务器端口
# 默认: 7861
PORT=7861

# ================================================================
# 密码配置 (支持分离密码)
# ================================================================

# 聊天API访问密码 (用于OpenAI和Gemini API端点认证)
# 默认: 继承通用密码或 pwd
API_PASSWORD=your_api_password

# 控制面板访问密码 (用于Web界面登录认证)
# 默认: 继承通用密码或 pwd
PANEL_PASSWORD=your_panel_password

# 通用访问密码 (兼容性保留)
# 设置后会覆盖上述两个专用密码，优先级最高
# 如果只想使用一个密码，设置此项即可
# 默认: pwd
PASSWORD=pwd

# ================================================================
# Google API 配置
# ================================================================

# Google Code Assist API 端点
# 默认: https://cloudcode-pa.googleapis.com
CODE_ASSIST_ENDPOINT=https://cloudcode-pa.googleapis.com

# 凭证文件目录
# 默认: ./creds
CREDENTIALS_DIR=./creds

# 是否自动从环境变量加载凭证
# 默认: false
AUTO_LOAD_ENV_CREDS=false

# Google 凭证环境变量配置 (可选，通过 GCLI_CREDS_* 环境变量提供凭证)
# 支持编号格式和项目名格式
# GCLI_CREDS_1={"client_id":"your-client-id","client_secret":"your-secret","refresh_token":"your-token","token_uri":"https://oauth2.googleapis.com/token","project_id":"your-project"}
# GCLI_CREDS_2={"client_id":"...","project_id":"..."}
# GCLI_CREDS_myproject={"client_id":"...","project_id":"myproject",...}

# ================================================================
# 凭证轮换配置
# ================================================================

# 每个凭证使用多少次调用后轮换到下一个
# 默认: 100
CALLS_PER_ROTATION=100

# ================================================================
# 网络配置
# ================================================================

# HTTP 请求超时时间 (秒)
# 默认: 30.0
HTTP_TIMEOUT=30.0

# 最大连接数
# 默认: 100
MAX_CONNECTIONS=100

# 代理配置 (可选)
# 支持 http, https, socks5 代理
# 格式: http://proxy:port, https://proxy:port, socks5://proxy:port
PROXY=http://localhost:7890

# ================================================================
# 错误处理和重试配置
# ================================================================

# 是否启用自动封禁功能
# 当凭证返回特定错误码时自动禁用该凭证
# 默认: false
AUTO_BAN=false

# 自动封禁的错误码列表 (逗号分隔)
# 默认: 400,403
AUTO_BAN_ERROR_CODES=400,403

# 是否启用 429 错误重试
# 默认: true
RETRY_429_ENABLED=true

# 429 错误最大重试次数
# 默认: 5
RETRY_429_MAX_RETRIES=5

# 429 错误重试间隔 (秒)
# 默认: 1
RETRY_429_INTERVAL=1

# ================================================================
# 日志配置
# ================================================================

# 日志级别
# 可选值: debug, info, warning, error, critical
# 默认: info
LOG_LEVEL=info

# 日志文件路径
# 默认: log.txt
LOG_FILE=log.txt

# ================================================================
# 高级功能配置
# ================================================================

# 流式抗截断最大尝试次数
# 用于 "流式抗截断/" 前缀的模型
# 默认: 3
ANTI_TRUNCATION_MAX_ATTEMPTS=3

# ================================================================
# 内存管理配置 (可选功能，默认不启用)
# ================================================================

# 是否启用自动内存监控
# 启用后会自动监控内存使用并在超限时执行清理
# 默认: false (不启用)
AUTO_START_MEMORY_MONITOR=false

# 最大内存限制 (MB)
# 设置应用最大可使用的内存，超过后会触发清理
# 默认: 100
MAX_MEMORY_MB=100

# 内存警告阈值 (百分比)
# 达到此阈值时记录警告日志
# 默认: 0.9 (90%)
MEMORY_WARNING_THRESHOLD=0.9

# 内存临界阈值 (百分比)  
# 达到此阈值时执行清理操作
# 默认: 0.95 (95%)
MEMORY_CRITICAL_THRESHOLD=0.95

# 内存检查间隔 (秒)
# 内存监控检查的频率
# 默认: 30
MEMORY_CHECK_INTERVAL=30

# ================================================================
# 环境变量使用说明
# ================================================================

# 1. 凭证配置方式 (三选一):
#    a) 将 Google 凭证 JSON 文件放在 CREDENTIALS_DIR 目录中
#    b) 通过 GOOGLE_CREDENTIALS 等环境变量直接提供
#    c) 设置 AUTO_LOAD_ENV_CREDS=true 自动从环境变量加载

# 2. 密码配置优先级:
#    a) PASSWORD 环境变量 (最高优先级，设置后覆盖其他密码)
#    b) API_PASSWORD / PANEL_PASSWORD 环境变量 (专用密码)
#    c) config.toml 文件中的密码配置
#    d) 默认值 "pwd"
#
# 3. 通用配置优先级:
#    环境变量 > config.toml 文件 > 默认值

# 4. 布尔值环境变量:
#    true/1/yes/on 表示启用
#    false/0/no/off 表示禁用

# 5. 模型功能说明:
#    - 基础模型: gemini-2.5-pro, gemini-2.5-flash 等
#    - 功能前缀:
#      * "假流式/" - 使用假流式传输
#      * "流式抗截断/" - 启用流式抗截断功能
#    - 功能后缀:
#      * "-maxthinking" - 最大思考预算
#      * "-nothinking" - 禁用思考模式
#      * "-search" - 启用 Google 搜索

# 6. 示例模型名称:
#    - gemini-2.5-pro
#    - 假流式/gemini-2.5-pro-maxthinking
#    - 流式抗截断/gemini-2.5-flash-search

# ================================================================
# 配置文件说明
# ================================================================

# 除了环境变量，你还可以使用 TOML 配置文件进行配置
# 配置文件位置: {CREDENTIALS_DIR}/config.toml
# 
# 示例 config.toml 内容:
# # 密码配置
# api_password = "your_api_password"        # 聊天API密码
# panel_password = "your_panel_password"    # 控制面板密码
# password = "your_common_password"         # 通用密码 (覆盖上述两个)
# 
# # 基础配置
# calls_per_rotation = 100
# http_timeout = 30.0
# max_connections = 100
# 
# [retry]
# retry_429_enabled = true
# retry_429_max_retries = 5
# retry_429_interval = 1
# 
# [logging]
# log_level = "info"
# log_file = "log.txt"
# 
# [auto_ban]
# auto_ban_enabled = false
# auto_ban_error_codes = [400, 403]